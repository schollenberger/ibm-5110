0010 REM *** SIO7IO  *** READ/WRITE TO SERIAL PORT
0020 REM 2025-07-31 WERNER SCHOLLENBERGER
0030 REM ****
0040 DIM X$2(256)
0050 REM A$ - ANSWER,  M$ - STORED ANSWER , B$ - SERIAL DATA
0055 REM V$,W$,E$ - SPECIAL CHARACTERS CR, LF and EOF
0060 DIM A$16,B$128,M$16
0070 PRINT 'INITIALIZING SERIAL PORT...'
0080 OPEN FL8,'A08',OUT
0090 REM PRINT FL8,'R/9600,I/32,O/32,F/C,K/I,N/1E,E/1E'
0100 REM 7 BIT CONFIG REQURES ONE CHAR FOR OPTIONS L B N E
0110 REM DEFAUTS L/X'9B'(CR) B/X'AA'(LF)
0112 V$=X'9B'
0113 W$=X'AA'
0120 PRINT FL8,'R/9600,I/32,O/32,F/C,K/I';
0130 PRINT FL8,',N/';V$;',E/';V$;',L/';V$;',B/';W$;',Z/E,Y/E'
0140 CLOSE FL8
0150 OPEN FL2,'A02',IN
0160 OPEN FL4,'A04',OUT
0170 PRINT 'SERIAL PORT INITIALIZED AND INPUT FILE OPEN'
0180 M$='READ'
0190 PRINT 'READ / SEND / CLOSE FILE / END  (';M$;')?'
0200 INPUT A$
0210 IF A$'?' GOTO 230
0220 A$=M$
0230 IF STR(A$,1,1)='R' GOTO 280
0240 IF STR(A$,1,1)='S' GOTO 350
0250 IF STR(A$,1,1)='E' GOTO 480
0255 IF STR(A$,1,1)='C' GOTO 610
0260 PRINT 'TYPE "R", "S", "C" or "E"'
0270 GOTO 190
0280 REM **** READ ****
0290 M$='READ'
0300 PRINT 'WAITING FOR DATA ON SERIAL PORT...'
0310 B$=''
0320 GET FL2,B$
0330 PRINT B$
0340 GOTO 190
0350 REM ***** SEND *****
0360 M$='SEND'
0370 PRINT 'SENDING DATA TO SERIAL PORT...'
0380 REM PAUSE
0390 REM IN 7-BIT VERSION DATA IS SENT AS IS
0400 REM PRINT '.';
0410 REM SHOULD TRANSLATE TO 'HALLO DU DA'
0420 REM B$='C8819393964084A4408481'
0430 REM B$='HALLO DU DA, WIE GEHT ES DIR?'
0440 REM B$='HALLO DU DA, WIE GEHT ES DIR?012345-LANGER STRING'
0450 B$='HALLO DU DA'
0460 GOSUB 540
0470 GOTO 190
0480 REM **** FINISH ****
0490 PRINT 'EXITING...'
0500 CLOSE FL2
0510 CLOSE FL4
0520 PRINT 'DONE'
0530 STOP
0540 REM ** SEND TO SERIAL PORT **
0550 REM WRITEFILE FLS,'F'
0560 REM FOR I=0 TO 4
0570 PRINT FL4,B$;
0580 REM NEXT I
0590 PRINT FL4
0600 RETURN
0610 REM **** SEND EOF CHAR TO CLOSE FILE AT the OTHER END
0614 PRINT 'SENDING EOF...'
0615 E$=X'AC'
0620 PRINT FL4,E$
0650 GOTO 190
