0010 REM *** SIOXFER EC.2006/12/05 H.RUFFNER ***
0020 OPEN FL8,'A08',OUT
0030 PRINT FL8,'R/9600,F/C,I/254,O/254,K/I,N/15,E/1E,L/00,B/1F'
0040 PRINT FL8,'Y/D'
0050 CLOSE FL8
0060 I,J,K=0
0070 DIM A$64,B$255,C$255,D$128,H$16,X$2(256)
0080 STR(C$,1,15)=X'0102030405060708090A0B0C0D0E0F'
0090 STR(C$,16,16)=X'101112131415161718191A1B1C1D1E1F'
0100 STR(C$,32,16)=X'202122232425262728292A2B2C2D2E2F'
0110 STR(C$,48,16)=X'303132333435363738393A3B3C3D3E3F'
0120 STR(C$,64,16)=X'404142434445464748494A4B4C4D4E4F'
0130 STR(C$,80,16)=X'505152535455565758595A5B5C5D5E5F'
0140 STR(C$,96,16)=X'606162636465666768696A6B6C6D6E6F'
0150 STR(C$,112,16)=X'707172737475767778797A7B7C7D7E7F'
0160 STR(C$,128,16)=X'808182838485868788898A8B8C8D8E8F'
0170 STR(C$,144,16)=X'909192939495969798999A9B9C9D9E9F'
0180 STR(C$,160,16)=X'A0A1A2A3A4A5A6A7A8A9AAABACADAEAF'
0190 STR(C$,176,16)=X'B0B1B2B3B4B5B6B7B8B9BABBBCBDBEBF'
0200 STR(C$,192,16)=X'C0C1C2C3C4C5C6C7C8C9CACBCCCDCECF'
0210 STR(C$,208,16)=X'D0D1D2D3D4D5D6D7D8D9DADBDCDDDEDF'
0220 STR(C$,224,16)=X'E0E1E2E3E4E5E6E7E8E9EAEBECEDEEEF'
0230 STR(C$,240,16)=X'F0F1F2F3F4F5F6F7F8F9FAFBFCFDFEFF'
0240 N$=X'15'
0250 H$='0123456789ABCDEF'
0260 FOR I=0 TO 255
0270 K=INT(I/16)
0280 J=I-K*16
0290 STR(X$(I+1),1,1)=STR(H$,K+1,1)
0300 STR(X$(I+1),2,1)=STR(H$,J+1,1)
0310 NEXT I
0320 OPEN FL2,'A02',IN
0330 OPEN FL4,'A04',OUT
0340 PRINT 'GUEST COMPUTER IS WAITING'
0350 GET FL2,B$
0360 PRINT B$
0370 IF STR(B$,1,2)ù'10' GOTO 400
0380 IF STR(B$,1,18)='10C4E2E3C6C9D3C57E' GOTO 430
0390 IF STR(B$,1,18)='10E2D9C3C6C9D3C57E' GOTO 550
0400 GOSUB 700
0410 PRINT A$
0420 GOTO 340
0425 REM
0426 REM COMMON SECTION
0427 REM
0430 PRINT ' *** PUT FILE TO 5110 ***'
0440 GOSUB 700
0450 GOSUB 920
0460 OPEN FL1,E$,F,F$,OUT
0470 GET FL2,B$
0480 IF B$='1A' GOTO 520
0490 GOSUB 700
0500 PRINT FL1,A$;N$;
0510 GOTO 470
0520 PRINT 'FILETRANSFER ENDED'
0530 CLOSE FL1
0540 GOTO 340
0550 PRINT ' *** GET FILE FROM 5110 ***'
0560 GOSUB 700
0570 GOSUB 920
0580 OPEN FILE FL1,E$,F,F$,IN
0590 READFILE FL1,A$,EOF 660
0600 PRINT A$
0610 FOR I=1 TO 100
0620 NEXT I
0630 GOSUB 840
0640 PRINT FL4,B$;'151E';
0650 GOTO 590
0660 PRINT FL4,'1A151E1F'
0670 PRINT 'FILETRANSFER ENDED'
0680 CLOSE FL1
0690 GOTO 340
0700 REM *** CONVERT FROM HEX ***
0710 A$=''
0720 WRITEFILE FLS,'F'
0730 FOR I=0 TO LEN(B$)-1 STEP 2
0740 J=IDX(H$,STR(B$,I+1,1))-1
0750 K=IDX(H$,STR(B$,I+2,1))-1
0760 IF J*16+K=0 GOTO 790
0770 STR(A$,INT(I/2)+1,1)=STR(C$,J*16+K,1)
0780 GOTO 800
0790 STR(A$,INT(I/2)+1,1)=X'00'
0800 NEXT I
0810 WRITEFILE FLS,'N'
0820 PRINT A$
0830 RETURN
0840 REM *** CONVERT TO HEX ***
0850 B$=''
0860 WRITEFILE FLS,'F'
0870 FOR I=0 TO LEN(A$)-1
0880 STR(B$,I*2+1,2)=X$(IDX(C$,STR(A$,I+1,1))+1)
0890 NEXT I
0900 WRITEFILE FLS,'N'
0910 RETURN
0920 REM *** EXTRACT FILENAME ***
0930 E$,F$=''
0940 F=0
0950 A$=STR(A$,10)
0960 IF IDX('ED',STR(A$,1,1))=0 GOTO 990
0970 E$=STR(A$,1,3)
0980 A$=STR(A$,IDX(A$,' ')+1)
0990 F=NUM(STR(A$,1,IDX(A$,' ')))
1000 F$=STR(A$,IDX(A$,' ')+1)
1010 PRINT 'FILE='E$;' ';F;' ';F$
1020 RETURN
