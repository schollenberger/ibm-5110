0010 REM *** SIOXFER EC.2007/10/12 H.RUFFNER ***
0020 OPEN FL8,'A08',OUT
0030 PRINT FL8,'R/9600,F/C,I/254,O/254,K/I,N/15,E/1E,L/00,B/1F'
0040 PRINT FL8,'Y/D'
0050 CLOSE FL8
0060 I,J,K=0
0070 DIM A$64,B$255,C$255,D$128,H$16,X$2(256)
0080 STR(C$,1,15)  =  X'FEFDFCFBFAF9F8F7F6F5F4F3F2F1F0'
0090 STR(C$,16,16) =X'EFEEEDECEBEAE9E8E7E6E5E4E3E2E1E0'
0100 STR(C$,32,16) =X'DFDEDDDCDBDAD9D8D7D6D5D4D3D2D1D0'
0110 STR(C$,48,16) =X'CFCECDCCCBCAC9C8C7C6C5C4C3C2C1C0'
0120 STR(C$,64,16) =X'BFBEBDBCBBBAB9B8B7B6B5B4B3B2B1B0'
0130 STR(C$,80,16) =X'AFAEADACABAAA9A8A7A6A5A4A3A2A1A0'
0140 STR(C$,96,16) =X'9F9E9D9C9B9A99989796959493929190'
0150 STR(C$,112,16)=X'8F8E8D8C8B8A89888786858483828180'
0160 STR(C$,128,16)=X'7F7E7D7C7B7A79787776757473727170'
0170 STR(C$,144,16)=X'6F6E6D6C6B6A69686766656463626160'
0180 STR(C$,160,16)=X'5F5E5D5C5B5A59585756555453525150'
0190 STR(C$,176,16)=X'4F4E4D4C4B4A49484746454443424140'
0200 STR(C$,192,16)=X'3F3E3D3C3B3A39383736353433323130'
0210 STR(C$,208,16)=X'2F2E2D2C2B2A29282726252423222120'
0220 STR(C$,224,16)=X'1F1E1D1C1B1A19181716151413121110'
0230 STR(C$,240,16)=X'0F0E0D0C0B0A09080706050403020100'
0240 N$=X'15'
0250 H$='FEDCBA9876543210'
0260 FOR I=0 TO 255
0270 K=INT(I/16)
0280 J=I-K*16
0290 STR(X$(I+1),1,1)=STR(H$,K+1,1)
0300 STR(X$(I+1),2,1)=STR(H$,J+1,1)
0310 NEXT I
0320 OPEN FL2,'A02',IN
0330 OPEN FL4,'A04',OUT
0340 PRINT 'GUEST COMPUTER IS WAITING'
0350 GET FL2,B$
0360 PRINT B$
0370 IF STR(B$,1,2)ù'10' GOTO 400
0380 IF STR(B$,1,18)='10C4E2E3C6C9D3C57E' GOTO 430
0390 IF STR(B$,1,18)='10E2D9C3C6C9D3C57E' GOTO 560
0400 GOSUB 720
0410 PRINT A$
0420 GOTO 340
0425 REM 
0426 REM COMMON SECTION
0427 REM
0430 PRINT ' *** PUT FILE TO 5110 ***'
0440 GOSUB 720
0450 GOSUB 940
0460 OPEN FL1,E$,F,F$,OUT
0470 GET FL2,B$
0480 IF B$='1A' GOTO 520
0490 GOSUB 720
0500 PRINT FL1,A$;N$;
0510 GOTO 470
0520 PRINT 'FILETRANSFER ENDED'
0530 WRITEFILE FLS,'A'
0540 CLOSE FL1
0550 GOTO 340
0560 PRINT ' *** GET FILE FROM 5110 ***'
0570 GOSUB 720
0580 GOSUB 940
0590 OPEN FILE FL1,E$,F,F$,IN
0600 READFILE FL1,A$,EOF 670
0610 PRINT A$
0620 FOR I=1 TO 100
0630 NEXT I
0640 GOSUB 860
0650 PRINT FL4,B$;'151E';
0660 GOTO 600
0670 PRINT FL4,'1A151E1F'
0680 PRINT 'FILETRANSFER ENDED'
0700 CLOSE FL1
0710 GOTO 340
0720 REM *** CONVERT FROM HEX ***
0730 WRITEFILE FLS,'F'
0740 A$=''
0750 FOR I=0 TO LEN(B$)-1 STEP 2
0760 J=IDX(H$,STR(B$,I+1,1))-1
0770 K=IDX(H$,STR(B$,I+2,1))-1
0780 IF J*16+K=0 GOTO 810
0790 STR(A$,INT(I/2)+1,1)=STR(C$,J*16+K,1)
0800 GOTO 820
0810 STR(A$,INT(I/2)+1,1)=X'FF'
0820 NEXT I
0830 WRITEFILE FLS,'N'
0840 PRINT A$
0850 RETURN
0860 REM *** CONVERT TO HEX ***
0870 B$=''
0880 WRITEFILE FLS,'F'
0890 FOR I=0 TO LEN(A$)-1
0900 STR(B$,I*2+1,2)=X$(IDX(C$,STR(A$,I+1,1))+1)
0910 NEXT I
0920 WRITEFILE FLS,'N'
0930 RETURN
0940 REM *** EXTRACT FILENAME ***
0950 E$,F$=''
0960 F=0
0970 A$=STR(A$,10)
0980 IF IDX('ED',STR(A$,1,1))=0 GOTO 1010
0990 E$=STR(A$,1,3)
1000 A$=STR(A$,IDX(A$,' ')+1)
1010 F=NUM(STR(A$,1,IDX(A$,' ')))
1020 F$=STR(A$,IDX(A$,' ')+1)
1030 PRINT 'FILE='E$;' ';F;' ';F$
1040 RETURN

